!function(e){"use strict";e.fn.sortByDepth=function(){var d=this.map(function(){return{length:e(this).parents().length,elt:this}}).get(),a=[],t=d.length;for(d.sort(function(e,d){return e.length-d.length});t--;)a.push(d[t].elt);return e(a)},e.fn.dividize=function(d){var a=e.extend({customHeaderTarget:"th",removeHeaders:!1,addLabelHeaders:!1,hideLabels:!0,preserveEvents:!1,preserveDim:!1,classes:"",enableAltRows:!1},d),t={container:{eventContainer:{}},save:function(d){var a=this;d.find("*").each(function(d,t){var n=e(t).data("events"),s="index-"+d;return"undefined"==typeof n?!0:(e.each(n,function(d,t){e.each(t,function(e,d){var t=d.namespace.length>0?d.type+"."+d.namespace:d.type;"undefined"==typeof a.container.eventContainer[s]&&(a.container.eventContainer[s]=[]),a.container.eventContainer[s].push({eventToBind:t,eventData:d.data,eventHandler:d.handler})})}),void e(t).attr("data-event-index",s))})},restore:function(d){var a=this;d.find("*").each(function(d,t){var n=e(t),s=n.attr("data-event-index");if("undefined"!=typeof s)for(var r=a.container.eventContainer[s],i=0;i<r.length;i++){var l=r[i];n.unbind(l.eventToBind),n.bind(l.eventToBind,l.eventData,l.eventHandler)}})}};a.preserveEvents&&t.save(this);var n=0;this.sortByDepth().replaceWith(function(){var d=e(this),s=d.find(a.customHeaderTarget),r=s.map(function(){return e(this).html()}).get();a.removeHeaders&&s.closest("tr").remove();var i=e("<div>").addClass("dvdz-box").addClass(a.classes),l=d.children("tr");l=l.add(d.children("tbody, thead").children("tr"));var v=l.length;return l.each(function(d){var t=e("<div>").addClass("dvdz-"+n++).addClass("dvdz-row").addClass("dvdz-row-"+d).appendTo(i);a.enableAltRows&&t.addClass(d%2===0?"even":"odd"),0===d?t.addClass("first-row"):d==v-1&&t.addClass("last-row");var s=e(this).children("td, "+a.customHeaderTarget),l=s.length;s.each(function(d,s){var i=e("<div>").addClass("dvdz-"+n++).addClass("dvdz-cell").addClass("dvdz-cell-"+d).addClass(e(this).is(a.customHeaderTarget)?"data-exth":"");if(0===d?i.addClass("first-cell"):d==l-1&&i.addClass("last-cell"),a.preserveDim&&(i.addClass("dvdz-dim-cell"),i.css({"line-height":e(s).outerHeight()+"px","min-height":e(s).outerHeight()+"px",width:e(s).outerWidth()+"px"})),a.addLabelHeaders&&!e(this).is(a.customHeaderTarget)){var v=e("<div>").addClass("dvdz-"+n++).addClass("dvdz-label").addClass("dvdz-label-"+d).html(r[d]);a.hideLabels&&v.addClass("dvdz-hidden"),i.append(v)}var o=e("<div>").addClass("dvdz-"+n++).addClass("dvdz-data").addClass("dvdz-data-"+d).html(e(this).html());a.preserveDim&&o.addClass("dvdz-dim-data"),i.append(o),i.appendTo(t)})}),a.preserveEvents&&t.restore(i),i})}}(jQuery);